#include "stdafx.h"

int main(int argc, char *argv[]) {

	BOOL success = true;

	Memory* MemoryManager = new Memory();
	DWORD64 ntoskrnlBaseAddress = MemoryManager->GetKernelBase("ntoskrnl.exe");

	//Gets a pointer to the EPROCESS of explorer
	std::string processName = "explorer.exe";
	DWORD64 peprocess = MemoryManager->GetEPROCESSPointer(ntoskrnlBaseAddress, processName);

	if (peprocess == NULL) {
		Logger::Info("Failed to get EPROCESS of process!");
		Logger::ShowKeyPress();
		exit(1);
	}
	
	Logger::InfoHex("EPROCESS Address", peprocess);

	DWORD64 baseAddress{};
	MemoryManager->VirtualRead(peprocess + EPROCESS_SECTIONBASEADDRESS, &baseAddress, sizeof(DWORD64));
	Logger::InfoHex("Base Address", baseAddress);

	Logger::ShowKeyPress();

}